<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>quarto-input380098a81c2ad05d – 金融工学ノート</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">金融工学ノート</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">ホーム</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./03-portfolio.html"> 
<span class="menu-text">ポートフォリオ理論</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./04-capm.qmd"> 
<span class="menu-text">CAPM</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ファンダメンタル分析fundamental-analysis" id="toc-ファンダメンタル分析fundamental-analysis" class="nav-link active" data-scroll-target="#ファンダメンタル分析fundamental-analysis">1. ファンダメンタル分析（Fundamental Analysis）</a>
  <ul class="collapse">
  <li><a href="#主な分析対象" id="toc-主な分析対象" class="nav-link" data-scroll-target="#主な分析対象">主な分析対象</a></li>
  <li><a href="#重要指標pe株価収益率" id="toc-重要指標pe株価収益率" class="nav-link" data-scroll-target="#重要指標pe株価収益率">重要指標：P/E（株価収益率）</a></li>
  <li><a href="#特徴" id="toc-特徴" class="nav-link" data-scroll-target="#特徴">特徴</a></li>
  </ul></li>
  <li><a href="#テクニカル分析technical-analysis" id="toc-テクニカル分析technical-analysis" class="nav-link" data-scroll-target="#テクニカル分析technical-analysis">2. テクニカル分析（Technical Analysis）</a>
  <ul class="collapse">
  <li><a href="#主な手法" id="toc-主な手法" class="nav-link" data-scroll-target="#主な手法">主な手法</a></li>
  <li><a href="#基本概念" id="toc-基本概念" class="nav-link" data-scroll-target="#基本概念">基本概念</a></li>
  <li><a href="#特徴-1" id="toc-特徴-1" class="nav-link" data-scroll-target="#特徴-1">特徴</a></li>
  </ul></li>
  <li><a href="#クオンツ分析quantitative-analysis" id="toc-クオンツ分析quantitative-analysis" class="nav-link" data-scroll-target="#クオンツ分析quantitative-analysis">3. クオンツ分析（Quantitative Analysis）</a>
  <ul class="collapse">
  <li><a href="#必要となる数学" id="toc-必要となる数学" class="nav-link" data-scroll-target="#必要となる数学">必要となる数学</a></li>
  <li><a href="#特徴-2" id="toc-特徴-2" class="nav-link" data-scroll-target="#特徴-2">特徴</a></li>
  </ul></li>
  <li><a href="#まとめ" id="toc-まとめ" class="nav-link" data-scroll-target="#まとめ">まとめ</a></li>
  <li><a href="#なぜランダム性を仮定するのか" id="toc-なぜランダム性を仮定するのか" class="nav-link" data-scroll-target="#なぜランダム性を仮定するのか">1. なぜランダム性を仮定するのか？</a></li>
  <li><a href="#リターンをランダム変数として表す" id="toc-リターンをランダム変数として表す" class="nav-link" data-scroll-target="#リターンをランダム変数として表す">2. リターンをランダム変数として表す</a></li>
  <li><a href="#正規分布がよく現れる理由中心極限定理" id="toc-正規分布がよく現れる理由中心極限定理" class="nav-link" data-scroll-target="#正規分布がよく現れる理由中心極限定理">3. 正規分布がよく現れる理由（中心極限定理）</a></li>
  <li><a href="#株価の変動もランダム変数で表す" id="toc-株価の変動もランダム変数で表す" class="nav-link" data-scroll-target="#株価の変動もランダム変数で表す">4. 株価の変動もランダム変数で表す</a></li>
  <li><a href="#ウィーナー過程wiener-processの特徴" id="toc-ウィーナー過程wiener-processの特徴" class="nav-link" data-scroll-target="#ウィーナー過程wiener-processの特徴">5. ウィーナー過程（Wiener Process）の特徴</a></li>
  <li><a href="#株価の大まかな振れ幅" id="toc-株価の大まかな振れ幅" class="nav-link" data-scroll-target="#株価の大まかな振れ幅">6. 株価の大まかな振れ幅</a></li>
  <li><a href="#今日の株価から明日の株価を予測する考え方" id="toc-今日の株価から明日の株価を予測する考え方" class="nav-link" data-scroll-target="#今日の株価から明日の株価を予測する考え方">7. 今日の株価から明日の株価を予測する考え方</a></li>
  <li><a href="#リターンは正規分布に従う" id="toc-リターンは正規分布に従う" class="nav-link" data-scroll-target="#リターンは正規分布に従う">1. リターンは正規分布に従う</a></li>
  <li><a href="#株価そのものは正規分布に従わない理由" id="toc-株価そのものは正規分布に従わない理由" class="nav-link" data-scroll-target="#株価そのものは正規分布に従わない理由">2. 株価そのものは正規分布に従わない理由</a>
  <ul class="collapse">
  <li><a href="#理由1株価は負の値を取れない" id="toc-理由1株価は負の値を取れない" class="nav-link" data-scroll-target="#理由1株価は負の値を取れない">理由1：株価は負の値を取れない</a></li>
  <li><a href="#理由2株価には長期的な上昇トレンドがある" id="toc-理由2株価には長期的な上昇トレンドがある" class="nav-link" data-scroll-target="#理由2株価には長期的な上昇トレンドがある">理由2：株価には長期的な上昇トレンドがある</a></li>
  </ul></li>
  <li><a href="#株価は対数正規分布に従う" id="toc-株価は対数正規分布に従う" class="nav-link" data-scroll-target="#株価は対数正規分布に従う">3. 株価は対数正規分布に従う</a></li>
  <li><a href="#株価変動はトレンド-ノイズ" id="toc-株価変動はトレンド-ノイズ" class="nav-link" data-scroll-target="#株価変動はトレンド-ノイズ">4. 株価変動は「トレンド + ノイズ」</a></li>
  <li><a href="#ウィーナー過程wiener-processの性質" id="toc-ウィーナー過程wiener-processの性質" class="nav-link" data-scroll-target="#ウィーナー過程wiener-processの性質">5. ウィーナー過程（Wiener Process）の性質</a></li>
  <li><a href="#幾何ブラウン運動geometric-brownian-motion-gbm" id="toc-幾何ブラウン運動geometric-brownian-motion-gbm" class="nav-link" data-scroll-target="#幾何ブラウン運動geometric-brownian-motion-gbm">6. 幾何ブラウン運動（Geometric Brownian Motion: GBM）</a>
  <ul class="collapse">
  <li><a href="#株価が大きいほど変動が大きくなる理由" id="toc-株価が大きいほど変動が大きくなる理由" class="nav-link" data-scroll-target="#株価が大きいほど変動が大きくなる理由">株価が大きいほど変動が大きくなる理由</a></li>
  </ul></li>
  <li><a href="#現代金融モデルへの応用" id="toc-現代金融モデルへの応用" class="nav-link" data-scroll-target="#現代金融モデルへの応用">7. 現代金融モデルへの応用</a></li>
  <li><a href="#まとめ-1" id="toc-まとめ-1" class="nav-link" data-scroll-target="#まとめ-1">まとめ</a>
  <ul class="collapse">
  <li><a href="#前提リターンとランダム性" id="toc-前提リターンとランダム性" class="nav-link" data-scroll-target="#前提リターンとランダム性">1. 前提：リターンとランダム性</a></li>
  <li><a href="#株価そのものではなく過程をモデル化する理由" id="toc-株価そのものではなく過程をモデル化する理由" class="nav-link" data-scroll-target="#株価そのものではなく過程をモデル化する理由">2. 株価そのものではなく「過程」をモデル化する理由</a></li>
  <li><a href="#数値シミュレーションの基本アイデア" id="toc-数値シミュレーションの基本アイデア" class="nav-link" data-scroll-target="#数値シミュレーションの基本アイデア">3. 数値シミュレーションの基本アイデア</a></li>
  <li><a href="#python実装ウィーナー過程クラス" id="toc-python実装ウィーナー過程クラス" class="nav-link" data-scroll-target="#python実装ウィーナー過程クラス">4. Python実装：ウィーナー過程クラス</a>
  <ul class="collapse">
  <li><a href="#特徴-3" id="toc-特徴-3" class="nav-link" data-scroll-target="#特徴-3">特徴</a></li>
  <li><a href="#コードwienerprocess-クラス" id="toc-コードwienerprocess-クラス" class="nav-link" data-scroll-target="#コードwienerprocess-クラス">コード：WienerProcess クラス</a></li>
  </ul></li>
  <li><a href="#株価モデルとしての評価" id="toc-株価モデルとしての評価" class="nav-link" data-scroll-target="#株価モデルとしての評価">5. 株価モデルとしての評価</a></li>
  <li><a href="#幾何ブラウン運動gbmへの接続" id="toc-幾何ブラウン運動gbmへの接続" class="nav-link" data-scroll-target="#幾何ブラウン運動gbmへの接続">6. 幾何ブラウン運動（GBM）への接続</a>
  <ul class="collapse">
  <li><a href="#特徴-4" id="toc-特徴-4" class="nav-link" data-scroll-target="#特徴-4">特徴</a></li>
  </ul></li>
  <li><a href="#まとめ-2" id="toc-まとめ-2" class="nav-link" data-scroll-target="#まとめ-2">7. まとめ</a></li>
  <li><a href="#普通の関数確定変数の微分" id="toc-普通の関数確定変数の微分" class="nav-link" data-scroll-target="#普通の関数確定変数の微分">1. 普通の関数（確定変数）の微分</a></li>
  <li><a href="#確率変数ウィーナー過程を含む場合はどうなるか" id="toc-確率変数ウィーナー過程を含む場合はどうなるか" class="nav-link" data-scroll-target="#確率変数ウィーナー過程を含む場合はどうなるか">2. 確率変数（ウィーナー過程）を含む場合はどうなるか？</a></li>
  <li><a href="#伊藤の補題itôs-lemma" id="toc-伊藤の補題itôs-lemma" class="nav-link" data-scroll-target="#伊藤の補題itôs-lemma">3. 伊藤の補題（Itô’s Lemma）</a></li>
  <li><a href="#taylor-展開からの導出直感" id="toc-taylor-展開からの導出直感" class="nav-link" data-scroll-target="#taylor-展開からの導出直感">4. Taylor 展開からの導出（直感）</a></li>
  <li><a href="#実際に計算してみるfxx2" id="toc-実際に計算してみるfxx2" class="nav-link" data-scroll-target="#実際に計算してみるfxx2">5. 実際に計算してみる：<span class="math inline">\(f(x)=x^2\)</span></a>
  <ul class="collapse">
  <li><a href="#関数" id="toc-関数" class="nav-link" data-scroll-target="#関数">関数</a></li>
  <li><a href="#次微分" id="toc-次微分" class="nav-link" data-scroll-target="#次微分">1次微分</a></li>
  <li><a href="#次微分-1" id="toc-次微分-1" class="nav-link" data-scroll-target="#次微分-1">2次微分</a></li>
  <li><a href="#伊藤の補題を適用" id="toc-伊藤の補題を適用" class="nav-link" data-scroll-target="#伊藤の補題を適用">伊藤の補題を適用</a></li>
  </ul></li>
  <li><a href="#普通の微分との比較" id="toc-普通の微分との比較" class="nav-link" data-scroll-target="#普通の微分との比較">6. 普通の微分との比較</a></li>
  <li><a href="#まとめ-3" id="toc-まとめ-3" class="nav-link" data-scroll-target="#まとめ-3">7. まとめ</a></li>
  <li><a href="#なぜ確率微分方程式sdeが必要なのか" id="toc-なぜ確率微分方程式sdeが必要なのか" class="nav-link" data-scroll-target="#なぜ確率微分方程式sdeが必要なのか">1. なぜ確率微分方程式（SDE）が必要なのか？</a></li>
  <li><a href="#株価のモデルsde一次元" id="toc-株価のモデルsde一次元" class="nav-link" data-scroll-target="#株価のモデルsde一次元">2. 株価のモデル：SDE（一次元）</a></li>
  <li><a href="#オプション価格は-2-変数の確率関数-になる" id="toc-オプション価格は-2-変数の確率関数-になる" class="nav-link" data-scroll-target="#オプション価格は-2-変数の確率関数-になる">3. オプション価格は <strong>2 変数の確率関数</strong> になる</a></li>
  <li><a href="#taylor-展開からの導出のイメージ" id="toc-taylor-展開からの導出のイメージ" class="nav-link" data-scroll-target="#taylor-展開からの導出のイメージ">4. Taylor 展開からの導出のイメージ</a></li>
  <li><a href="#必要な項だけ残すと" id="toc-必要な項だけ残すと" class="nav-link" data-scroll-target="#必要な項だけ残すと">5. 必要な項だけ残すと…</a></li>
  <li><a href="#なぜこれが重要なのか" id="toc-なぜこれが重要なのか" class="nav-link" data-scroll-target="#なぜこれが重要なのか">6. なぜこれが重要なのか？</a></li>
  <li><a href="#まとめ-4" id="toc-まとめ-4" class="nav-link" data-scroll-target="#まとめ-4">7. まとめ</a></li>
  <li><a href="#幾何ブラウン運動gbmの定義" id="toc-幾何ブラウン運動gbmの定義" class="nav-link" data-scroll-target="#幾何ブラウン運動gbmの定義">1. 幾何ブラウン運動（GBM）の定義</a></li>
  <li><a href="#まず式を対数微分の形にする" id="toc-まず式を対数微分の形にする" class="nav-link" data-scroll-target="#まず式を対数微分の形にする">2. まず式を「対数微分の形」にする</a></li>
  <li><a href="#伊藤の補題itôs-lemmaを適用" id="toc-伊藤の補題itôs-lemmaを適用" class="nav-link" data-scroll-target="#伊藤の補題itôs-lemmaを適用">3. 伊藤の補題（Itô’s Lemma）を適用</a>
  <ul class="collapse">
  <li><a href="#次微分-2" id="toc-次微分-2" class="nav-link" data-scroll-target="#次微分-2">1次微分</a></li>
  <li><a href="#次微分-3" id="toc-次微分-3" class="nav-link" data-scroll-target="#次微分-3">2次微分</a></li>
  </ul></li>
  <li><a href="#ds2-を計算する" id="toc-ds2-を計算する" class="nav-link" data-scroll-target="#ds2-を計算する">4. <span class="math inline">\((dS)^2\)</span> を計算する</a></li>
  <li><a href="#伊藤の補題に代入" id="toc-伊藤の補題に代入" class="nav-link" data-scroll-target="#伊藤の補題に代入">5. 伊藤の補題に代入</a></li>
  <li><a href="#両辺を積分して明示解を得る" id="toc-両辺を積分して明示解を得る" class="nav-link" data-scroll-target="#両辺を積分して明示解を得る">6. 両辺を積分して明示解を得る</a></li>
  <li><a href="#幾何ブラウン運動の解の特徴" id="toc-幾何ブラウン運動の解の特徴" class="nav-link" data-scroll-target="#幾何ブラウン運動の解の特徴">7. 幾何ブラウン運動の解の特徴</a></li>
  <li><a href="#まとめ-5" id="toc-まとめ-5" class="nav-link" data-scroll-target="#まとめ-5">8. まとめ</a></li>
  <li><a href="#幾何ブラウン運動の復習" id="toc-幾何ブラウン運動の復習" class="nav-link" data-scroll-target="#幾何ブラウン運動の復習">1. 幾何ブラウン運動の復習</a></li>
  <li><a href="#gbm-シミュレーションのアルゴリズム" id="toc-gbm-シミュレーションのアルゴリズム" class="nav-link" data-scroll-target="#gbm-シミュレーションのアルゴリズム">2. GBM シミュレーションのアルゴリズム</a></li>
  <li><a href="#python-コード幾何ブラウン運動gbmの実装" id="toc-python-コード幾何ブラウン運動gbmの実装" class="nav-link" data-scroll-target="#python-コード幾何ブラウン運動gbmの実装">3. Python コード：幾何ブラウン運動（GBM）の実装</a></li>
  <li><a href="#出力される株価軌道の特徴" id="toc-出力される株価軌道の特徴" class="nav-link" data-scroll-target="#出力される株価軌道の特徴">4. 出力される株価軌道の特徴</a></li>
  <li><a href="#このモデルが株価に適している理由" id="toc-このモデルが株価に適している理由" class="nav-link" data-scroll-target="#このモデルが株価に適している理由">5. このモデルが株価に適している理由</a></li>
  <li><a href="#まとめ-6" id="toc-まとめ-6" class="nav-link" data-scroll-target="#まとめ-6">6. まとめ</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<p><a href="https://colab.research.google.com/github/ish66726-a11y/colab-notebooks/blob/main/%E3%83%96%E3%83%A9%E3%83%83%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%AB%E3%82%BA%E3%83%A2%E3%83%87%E3%83%AB.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<p>#ファイナンスにおけるランダム性</p>
<p>##6-1分析手法の種類</p>
<p>この講義では、3つの主要な分析手法について解説しています。</p>
<hr>
<section id="ファンダメンタル分析fundamental-analysis" class="level2">
<h2 class="anchored" data-anchor-id="ファンダメンタル分析fundamental-analysis">1. ファンダメンタル分析（Fundamental Analysis）</h2>
<p>企業そのものを詳しく調査し、本質的価値（Intrinsic Value）に対して株価が割安かどうかを判断する手法。</p>
<section id="主な分析対象" class="level3">
<h3 class="anchored" data-anchor-id="主な分析対象">主な分析対象</h3>
<ul>
<li>経営陣</li>
<li>製品・サービス</li>
<li>資産（現金・設備など）</li>
<li>負債（借金・ローン）</li>
<li>損益計算書（収益・費用）</li>
<li>貸借対照表</li>
<li>キャッシュフロー計算書</li>
</ul>
</section>
<section id="重要指標pe株価収益率" class="level3">
<h3 class="anchored" data-anchor-id="重要指標pe株価収益率">重要指標：P/E（株価収益率）</h3>
<ol type="1">
<li>純利益 ÷ 発行済株式数 = EPS<br>
</li>
<li>株価 ÷ EPS = P/E比率<br>
→ <strong>低いほど割安</strong></li>
</ol>
</section>
<section id="特徴" class="level3">
<h3 class="anchored" data-anchor-id="特徴">特徴</h3>
<ul>
<li>本質的価値を重視<br>
</li>
<li>需給がすぐに反映されない場合、正しく割安でも株価が上がらないこともある<br>
</li>
<li>長期投資向けの手法</li>
</ul>
<hr>
</section>
</section>
<section id="テクニカル分析technical-analysis" class="level2">
<h2 class="anchored" data-anchor-id="テクニカル分析technical-analysis">2. テクニカル分析（Technical Analysis）</h2>
<p>企業の情報は株価にすべて反映されていると仮定し、<strong>過去の価格データから未来を予測する手法</strong>。</p>
<section id="主な手法" class="level3">
<h3 class="anchored" data-anchor-id="主な手法">主な手法</h3>
<ul>
<li>移動平均線（SMA）</li>
<li>RSI（相対力指数）</li>
<li>AR / ARIMA モデル</li>
<li>ロジスティック回帰、SVM、DNN などの機械学習モデル</li>
</ul>
</section>
<section id="基本概念" class="level3">
<h3 class="anchored" data-anchor-id="基本概念">基本概念</h3>
<blockquote class="blockquote">
<p>過去に見られたパターンは将来も繰り返される<br>
→ 過去データから未来の動きを予測する</p>
</blockquote>
</section>
<section id="特徴-1" class="level3">
<h3 class="anchored" data-anchor-id="特徴-1">特徴</h3>
<ul>
<li>チャートの形やパターンを重視<br>
</li>
<li>企業の財務情報は直接見ない<br>
</li>
<li>短期〜中期取引に有効</li>
</ul>
<hr>
</section>
</section>
<section id="クオンツ分析quantitative-analysis" class="level2">
<h2 class="anchored" data-anchor-id="クオンツ分析quantitative-analysis">3. クオンツ分析（Quantitative Analysis）</h2>
<p>高度な数学と確率論を用いて、金融商品のランダムな動きをモデル化する手法。</p>
<section id="必要となる数学" class="level3">
<h3 class="anchored" data-anchor-id="必要となる数学">必要となる数学</h3>
<ul>
<li>統計学</li>
<li>確率論</li>
<li>確率過程</li>
<li>確率微分方程式（SDE）</li>
<li>ストキャスティック・カルキュラス（確率解析）</li>
</ul>
</section>
<section id="特徴-2" class="level3">
<h3 class="anchored" data-anchor-id="特徴-2">特徴</h3>
<ul>
<li>資産のランダム性を前提とする<br>
</li>
<li>ポートフォリオ最適化などでリスクを最小化<br>
</li>
<li>モデル例：ブラック＝ショールズ方程式（オプション価格計算）</li>
</ul>
<hr>
</section>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">まとめ</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 41%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>手法</th>
<th>何を見る？</th>
<th>主な特徴</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ファンダメンタル分析</td>
<td>企業の価値・財務</td>
<td>割安/割高を判断、長期向け</td>
</tr>
<tr class="even">
<td>テクニカル分析</td>
<td>過去の価格データ</td>
<td>パターン分析で未来を予測、短期向け</td>
</tr>
<tr class="odd">
<td>クオンツ分析</td>
<td>数学モデル・確率過程</td>
<td>ランダム性を数式化、高度で精密</td>
</tr>
</tbody>
</table>
<hr>
<p>##6-2 資産のランダム性（確率的挙動）</p>
<p>金融資産が「ランダムに振る舞う」という前提の背景と、その理由について解説する。</p>
<hr>
</section>
<section id="なぜランダム性を仮定するのか" class="level2">
<h2 class="anchored" data-anchor-id="なぜランダム性を仮定するのか">1. なぜランダム性を仮定するのか？</h2>
<p>クオンツ分析では、<strong>株価・金利・オプション価格などはランダムに動く</strong>と仮定する。</p>
<p>その理由は、実際の市場データ（特に<strong>日次リターン</strong>）を調べると、以下のような特徴があるため：</p>
<ul>
<li>日次リターン = (今日の株価 − 昨日の株価) ÷ 昨日の株価</li>
<li>日次リターンのヒストグラムを描画すると<br>
→ <strong>平均0の正規分布に非常に近い形状</strong>になる</li>
<li>月次リターンでも同様の傾向がある</li>
</ul>
<p>正規分布は<br>
<strong>「平均」「分散（または標準偏差）」</strong> の 2 つのパラメータで特徴付けられる。</p>
<p>標準偏差 = 分散の平方根。</p>
<p>→ <strong>リターンは正規分布からの乱数とみなせる</strong><br>
という結論に至る。</p>
<hr>
</section>
<section id="リターンをランダム変数として表す" class="level2">
<h2 class="anchored" data-anchor-id="リターンをランダム変数として表す">2. リターンをランダム変数として表す</h2>
<p>リターン $ R $ は次のように表せる：</p>
<p><span class="math display">\[
R = \mu + \sigma \varepsilon
\]</span></p>
<ul>
<li>$ $：平均（決定論的部分）</li>
<li>$ $：標準偏差</li>
<li>$ $：正規分布からの乱数（ランダム部分）</li>
</ul>
<p>これは日次リターンが正規分布に従うという観察に基づいている。</p>
<hr>
</section>
<section id="正規分布がよく現れる理由中心極限定理" class="level2">
<h2 class="anchored" data-anchor-id="正規分布がよく現れる理由中心極限定理">3. 正規分布がよく現れる理由（中心極限定理）</h2>
<p>複数の独立な確率変数を足し合わせると、その和は正規分布に近づく。</p>
<p>これが <strong>中心極限定理（Central Limit Theorem）</strong>。</p>
<p>そのため金融市場だけでなく、物理・統計などあらゆる分野で正規分布が頻出する。</p>
<hr>
</section>
<section id="株価の変動もランダム変数で表す" class="level2">
<h2 class="anchored" data-anchor-id="株価の変動もランダム変数で表す">4. 株価の変動もランダム変数で表す</h2>
<p>リターンだけでなく <strong>株価そのものの未来値もランダム変数</strong> として扱える。</p>
<p>例：</p>
<ul>
<li>今日の株価：$ S_t $</li>
<li>明日の株価：$ S_{t+1} $<br>
→ <strong>正規分布からの乱数</strong>として扱える</li>
</ul>
<p>これが <strong>ウィーナー過程（Wiener Process）</strong> を使ったモデル化の考え方につながる。</p>
<hr>
</section>
<section id="ウィーナー過程wiener-processの特徴" class="level2">
<h2 class="anchored" data-anchor-id="ウィーナー過程wiener-processの特徴">5. ウィーナー過程（Wiener Process）の特徴</h2>
<p>ウィーナー過程（ブラウン運動）は：</p>
<ul>
<li><strong>連続的なパスを持つ</strong></li>
<li><strong>増分が独立で、かつ正規分布に従う</strong></li>
</ul>
<p>株価の変化をこのプロセスでモデル化するのは、<br>
「日次リターンが正規分布に従う」という経験的事実に基づく。</p>
<hr>
</section>
<section id="株価の大まかな振れ幅" class="level2">
<h2 class="anchored" data-anchor-id="株価の大まかな振れ幅">6. 株価の大まかな振れ幅</h2>
<p>将来の株価は不確実だが、次の範囲に収まる可能性が高い：</p>
<p><span class="math display">\[
\mu \pm 1 \sigma
\]</span></p>
<ul>
<li>平均（トレンド）<br>
</li>
<li>± 標準偏差（ばらつき）</li>
</ul>
<p>多くの場合、株価はこのレンジ内で推移する。</p>
<hr>
</section>
<section id="今日の株価から明日の株価を予測する考え方" class="level2">
<h2 class="anchored" data-anchor-id="今日の株価から明日の株価を予測する考え方">7. 今日の株価から明日の株価を予測する考え方</h2>
<p>今日の株価を $ S_t $ とすると、明日の株価 $ S_{t+1} $ は：</p>
<p><span class="math display">\[
S_{t+1} \sim \text{Normal}(\text{mean}, \text{variance})
\]</span></p>
<p>つまり <strong>株価の将来値そのものがランダムウォークである</strong>。</p>
<p>これがクオンツ分析の基本的な前提となる。</p>
<p>##6-3 金融資産の数学的背景：ウィーナー過程とランダムウォーク</p>
<p>この講義では、金融資産の確率的挙動を説明するための <strong>ウィーナー過程（Wiener Process）</strong> と<br>
<strong>ランダムウォーク（特に幾何ブラウン運動）</strong> について解説する。</p>
<hr>
</section>
<section id="リターンは正規分布に従う" class="level2">
<h2 class="anchored" data-anchor-id="リターンは正規分布に従う">1. リターンは正規分布に従う</h2>
<p>株価 <span class="math inline">\(S_t\)</span> を使うと <strong>日次リターン</strong> は次の式で計算できる：</p>
<p>$ = $</p>
<p>日次リターンのヒストグラムは：</p>
<ul>
<li>平均はほぼ 0<br>
</li>
<li>一定の分散（標準偏差）<br>
</li>
<li>正規分布に非常に近い形状</li>
</ul>
<p>→ <strong>リターンは正規分布に従う</strong> とみなせる。</p>
<hr>
</section>
<section id="株価そのものは正規分布に従わない理由" class="level2">
<h2 class="anchored" data-anchor-id="株価そのものは正規分布に従わない理由">2. 株価そのものは正規分布に従わない理由</h2>
<section id="理由1株価は負の値を取れない" class="level3">
<h3 class="anchored" data-anchor-id="理由1株価は負の値を取れない">理由1：株価は負の値を取れない</h3>
<p>正規分布は負の値が出る → モデルとして破綻。</p>
</section>
<section id="理由2株価には長期的な上昇トレンドがある" class="level3">
<h3 class="anchored" data-anchor-id="理由2株価には長期的な上昇トレンドがある">理由2：株価には長期的な上昇トレンドがある</h3>
<p>Apple、Tesla、Google などの株価は <strong>長期では上昇し続ける傾向</strong> にある。</p>
<p>→ 完全なランダムウォーク（通常の正規分布）では説明できない。</p>
<hr>
</section>
</section>
<section id="株価は対数正規分布に従う" class="level2">
<h2 class="anchored" data-anchor-id="株価は対数正規分布に従う">3. 株価は対数正規分布に従う</h2>
<p>株価 <span class="math inline">\(S_t\)</span> ではなく <strong>その対数 <span class="math inline">\(\ln S_t\)</span> が正規分布に従う</strong> と仮定する。</p>
<p>$ S_t (, ^2) $</p>
<p>つまり株価そのものは <strong>対数正規分布（lognormal distribution）</strong>。</p>
<p>この仮定により：</p>
<ul>
<li>株価は負にならない<br>
</li>
<li>長期的に指数関数的な増加が可能<br>
</li>
<li>株価が大きくなると変動も大きくなる（実際の市場と一致）</li>
</ul>
<hr>
</section>
<section id="株価変動はトレンド-ノイズ" class="level2">
<h2 class="anchored" data-anchor-id="株価変動はトレンド-ノイズ">4. 株価変動は「トレンド + ノイズ」</h2>
<p>株価の動きは以下に分解できる：</p>
<ol type="1">
<li><p><strong>決定論的部分（ドリフト）</strong><br>
→ 長期トレンドを表すパラメータ <span class="math inline">\(\mu\)</span></p></li>
<li><p><strong>確率的部分（ランダム変動）</strong><br>
→ ボラティリティを表すパラメータ <span class="math inline">\(\sigma\)</span></p></li>
</ol>
<p>標準偏差と分散の関係：</p>
<p>$ = $</p>
<hr>
</section>
<section id="ウィーナー過程wiener-processの性質" class="level2">
<h2 class="anchored" data-anchor-id="ウィーナー過程wiener-processの性質">5. ウィーナー過程（Wiener Process）の性質</h2>
<p>ウィーナー過程 <span class="math inline">\(W_t\)</span> の増分は次の性質を持つ：</p>
<p>$ W_{t+t} - W_t (0, t) $</p>
<ul>
<li>増分は独立<br>
</li>
<li>増分は正規分布<br>
</li>
<li>サンプルパスは連続</li>
</ul>
<hr>
</section>
<section id="幾何ブラウン運動geometric-brownian-motion-gbm" class="level2">
<h2 class="anchored" data-anchor-id="幾何ブラウン運動geometric-brownian-motion-gbm">6. 幾何ブラウン運動（Geometric Brownian Motion: GBM）</h2>
<p>金融工学で最も重要なSDE（確率微分方程式）はこれ：</p>
<p>$ dS_t = S_t , dt + S_t , dW_t $</p>
<p>意味：</p>
<ul>
<li><span class="math inline">\(dS_t\)</span>：株価の微小変化<br>
</li>
<li><span class="math inline">\(\mu S_t dt\)</span>：決定論的トレンド<br>
</li>
<li><span class="math inline">\(\sigma S_t dW_t\)</span>：確率的変動（ボラティリティ）<br>
</li>
<li><span class="math inline">\(dW_t\)</span>：正規分布 <span class="math inline">\(\mathcal{N}(0, dt)\)</span> に従う増分</li>
</ul>
<section id="株価が大きいほど変動が大きくなる理由" class="level3">
<h3 class="anchored" data-anchor-id="株価が大きいほど変動が大きくなる理由">株価が大きいほど変動が大きくなる理由</h3>
<p>式の通り：</p>
<p>$ S_t $</p>
<p>→ 株価が成長すると変動が自然に大きくなる（実データと一致）。</p>
<hr>
</section>
</section>
<section id="現代金融モデルへの応用" class="level2">
<h2 class="anchored" data-anchor-id="現代金融モデルへの応用">7. 現代金融モデルへの応用</h2>
<p>この</p>
<p>$ dS_t = S_t dt + S_t dW_t $</p>
<p>は現代金融工学の中心であり：</p>
<ul>
<li>ブラック＝ショールズモデル<br>
</li>
<li>金利モデル（Vasicek、CIR など）<br>
</li>
<li>デリバティブ価格付け</li>
</ul>
<p>といった多くの理論の基盤。</p>
<hr>
</section>
<section id="まとめ-1" class="level1">
<h1>まとめ</h1>
<ul>
<li>リターンは正規分布<br>
</li>
<li>株価は負の値を取れないので <strong>対数正規分布</strong><br>
</li>
<li>長期トレンドは <span class="math inline">\(\mu\)</span>、短期変動は <span class="math inline">\(\sigma\)</span><br>
</li>
<li>ノイズ部分はウィーナー過程に従う<br>
</li>
<li>株価変動の標準モデル：<br>
$ dS_t = S_t dt + S_t dW_t $</li>
</ul>
<p>##6-4 ウィーナー過程とランダムウォークのシミュレーション</p>
<p>この資料は、講義で説明されていた「ウィーナー過程を Python でシミュレーションする話」を日本語で整理しつつ、実際に動かせるコードをオブジェクト指向（クラスベース）形式でまとめたものです。</p>
<hr>
<section id="前提リターンとランダム性" class="level2">
<h2 class="anchored" data-anchor-id="前提リターンとランダム性">1. 前提：リターンとランダム性</h2>
<p>株価のリターン（日次リターン）は次の式で定義されます。</p>
<p>$ = $</p>
<p>実データからリターンのヒストグラムを作ると次の特徴があります。</p>
<ul>
<li>平均はほぼ 0<br>
</li>
<li>正規分布に非常に近い形</li>
</ul>
<p>→ よって <strong>リターンは正規分布に従う確率変数として扱える</strong> と考えられます。</p>
<hr>
</section>
<section id="株価そのものではなく過程をモデル化する理由" class="level2">
<h2 class="anchored" data-anchor-id="株価そのものではなく過程をモデル化する理由">2. 株価そのものではなく「過程」をモデル化する理由</h2>
<p>株価の動きを連続時間で変化する確率過程として扱うため、次の概念が登場します。</p>
<ul>
<li>ウィーナー過程（ブラウン運動）<br>
</li>
<li>ランダムウォーク</li>
</ul>
<p>ウィーナー過程 <span class="math inline">\(W(t)\)</span> の性質：</p>
<ul>
<li><strong>独立増分</strong><br>
</li>
<li><strong>正規増分</strong>（平均 0、分散 <span class="math inline">\(\Delta t\)</span>）</li>
</ul>
<p>式で表すと：</p>
<p>$ W(t + t) - W(t) N(0, t) $</p>
<hr>
</section>
<section id="数値シミュレーションの基本アイデア" class="level2">
<h2 class="anchored" data-anchor-id="数値シミュレーションの基本アイデア">3. 数値シミュレーションの基本アイデア</h2>
<p>連続時間の確率過程をコンピュータで扱うため、小さい時間刻み <span class="math inline">\(dt\)</span> を使って近似します。</p>
<p>手順：</p>
<ol type="1">
<li>標準正規乱数 <span class="math inline">\(Z \sim N(0,1)\)</span> を生成<br>
</li>
<li>増分 <span class="math inline">\(dW = \sqrt{dt} \times Z\)</span> を計算<br>
</li>
<li>初期値 <span class="math inline">\(W(0)=0\)</span> とし、累積和で <span class="math inline">\(W(t)\)</span> を構築</li>
</ol>
<hr>
</section>
<section id="python実装ウィーナー過程クラス" class="level2">
<h2 class="anchored" data-anchor-id="python実装ウィーナー過程クラス">4. Python実装：ウィーナー過程クラス</h2>
<p>以下に示すクラス <strong>WienerProcess</strong> は、ウィーナー過程の生成と可視化を扱います。</p>
<section id="特徴-3" class="level3">
<h3 class="anchored" data-anchor-id="特徴-3">特徴</h3>
<ul>
<li>時間刻み <span class="math inline">\(dt\)</span> とステップ数 <span class="math inline">\(N\)</span> を設定<br>
</li>
<li><code>generate_path</code>：パスを生成<br>
</li>
<li><code>plot_path</code>：結果をプロット</li>
</ul>
<hr>
</section>
<section id="コードwienerprocess-クラス" class="level3">
<h3 class="anchored" data-anchor-id="コードwienerprocess-クラス">コード：WienerProcess クラス</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.random <span class="im">as</span> npr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WienerProcess:</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dt<span class="op">=</span><span class="fl">0.1</span>, N<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">        初期化</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        dt : 時間刻み</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        N  : ステップ数</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dt <span class="op">=</span> dt</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.N <span class="op">=</span> N</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.t <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_path(<span class="va">self</span>):</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">        ウィーナー過程 W(t) を生成して内部に保持する</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 時間軸</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="va">self</span>.N <span class="op">*</span> <span class="va">self</span>.dt, <span class="va">self</span>.N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 標準正規乱数 Z ~ N(0, 1)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> npr.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="va">self</span>.N)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 増分 dW = sqrt(dt) * Z</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        dW <span class="op">=</span> np.sqrt(<span class="va">self</span>.dt) <span class="op">*</span> Z</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 初期値 0 の配列</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> np.zeros(<span class="va">self</span>.N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 累積和で W を構築</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W[<span class="dv">1</span>:] <span class="op">=</span> np.cumsum(dW)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.t, <span class="va">self</span>.W</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_path(<span class="va">self</span>):</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">        生成されたパスをプロットする</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.W <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.generate_path()</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.t, <span class="va">self</span>.W, label<span class="op">=</span><span class="st">"Wiener Process"</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">"W(t)"</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">"Wiener Process Simulation"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        plt.legend()</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># メイン処理</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    process <span class="op">=</span> WienerProcess(dt<span class="op">=</span><span class="fl">0.1</span>, N<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    process.plot_path()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="株価モデルとしての評価" class="level2">
<h2 class="anchored" data-anchor-id="株価モデルとしての評価">5. 株価モデルとしての評価</h2>
<p>ウィーナー過程の特徴（欠点）</p>
<ul>
<li>値が正にも負にもなる<br>
</li>
<li>長期的トレンドが 0<br>
</li>
<li>ランダムなギザギザした動き</li>
</ul>
<p>一方、実際の株価の特徴は：</p>
<ul>
<li>負にならない（最小値は 0）<br>
</li>
<li>長期的に上昇トレンドをもつ<br>
</li>
<li>株価が高いほど変動（ボラティリティ）も大きくなる</li>
</ul>
<p>→ よって、<strong>ウィーナー過程そのままでは株価のモデルとして不適。</strong></p>
<hr>
</section>
<section id="幾何ブラウン運動gbmへの接続" class="level2">
<h2 class="anchored" data-anchor-id="幾何ブラウン運動gbmへの接続">6. 幾何ブラウン運動（GBM）への接続</h2>
<p>株価のモデルには、次の確率微分方程式（SDE）が一般的に使われます。</p>
<p>$ dS(t) = S(t),dt + S(t),dW(t) $</p>
<section id="特徴-4" class="level3">
<h3 class="anchored" data-anchor-id="特徴-4">特徴</h3>
<ul>
<li>決定論的トレンド <span class="math inline">\(\mu\)</span>（期待リターン）<br>
</li>
<li>ランダム変動 <span class="math inline">\(\sigma\)</span>（ボラティリティ）<br>
</li>
<li>解が指数関数形 → <strong>負値にならない</strong><br>
</li>
<li>現代金融工学の標準モデル</li>
</ul>
<hr>
</section>
</section>
<section id="まとめ-2" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-2">7. まとめ</h2>
<ul>
<li>リターンは正規分布として扱える<br>
</li>
<li>ウィーナー過程は最も基本的な確率過程<br>
</li>
<li>numpy の累積和で簡単にシミュレーション可能<br>
</li>
<li>しかし株価を表すには不十分（負値・トレンドがない）<br>
</li>
<li>そのため、<strong>幾何ブラウン運動（GBM）</strong> が株価モデルとして使われる</li>
</ul>
<p>##6-5 伊藤計算と確率変数の微分</p>
<p>この資料では、講義で説明されていた<br>
<strong>「確率微分方程式（SDE）を解くための伊藤計算（Itô calculus）」</strong><br>
について、内容を整理したものです。</p>
<hr>
</section>
<section id="普通の関数確定変数の微分" class="level2">
<h2 class="anchored" data-anchor-id="普通の関数確定変数の微分">1. 普通の関数（確定変数）の微分</h2>
<p>まず、確定変数 <span class="math inline">\(x\)</span> をもつ通常の関数を考えます。</p>
<p>例：<br>
<span class="math inline">\(f(x) = x^2\)</span></p>
<p>この微分は：</p>
<p><span class="math inline">\(\frac{df}{dx} = 2x\)</span></p>
<p>小さな変化 <span class="math inline">\(dx\)</span> に対する変化は、</p>
<p><span class="math inline">\(df = 2x\,dx\)</span></p>
<p>これは普通の微分の公式であり、<br>
関数が確定的で、<span class="math inline">\(x\)</span> がランダムでない場合に成り立つ。</p>
<hr>
</section>
<section id="確率変数ウィーナー過程を含む場合はどうなるか" class="level2">
<h2 class="anchored" data-anchor-id="確率変数ウィーナー過程を含む場合はどうなるか">2. 確率変数（ウィーナー過程）を含む場合はどうなるか？</h2>
<p>今度は <span class="math inline">\(x\)</span> が <strong>確率変数（例：ウィーナー過程 <span class="math inline">\(W_t\)</span>）</strong> の場合を考える。</p>
<p>ウィーナー過程の性質：</p>
<ul>
<li><span class="math inline">\(dW\)</span> は平均 0、分散 <span class="math inline">\(dt\)</span> の正規分布<br>
</li>
<li>つまり<br>
<span class="math inline">\(dW \sim N(0, dt)\)</span></li>
</ul>
<p>ここで問題：</p>
<blockquote class="blockquote">
<p>普通の微分法則 <span class="math inline">\(df = f'(x)\,dx\)</span> はそのまま使えるか？</p>
</blockquote>
<p>→ <strong>使えない。</strong></p>
<p>理由：<br>
<span class="math inline">\(W_t\)</span> は確率変数であり、<span class="math inline">\(dW\)</span> は無限小ではあるがランダムで、<br>
しかも二乗すると <span class="math inline">\(dW^2 = dt\)</span> という非常に特殊な性質を持つため。</p>
<hr>
</section>
<section id="伊藤の補題itôs-lemma" class="level2">
<h2 class="anchored" data-anchor-id="伊藤の補題itôs-lemma">3. 伊藤の補題（Itô’s Lemma）</h2>
<p>確率変数を含む関数 <span class="math inline">\(f(x)\)</span> の変化は次で与えられる：</p>
<p><span class="math inline">\(df = f'(x)\,dx + \frac{1}{2} f''(x)\,(dx)^2\)</span></p>
<p>ここで、ウィーナー過程の性質</p>
<ul>
<li><span class="math inline">\(dW\)</span> の期待値は 0</li>
<li><span class="math inline">\((dW)^2 = dt\)</span></li>
</ul>
<p>を使う。</p>
<p>ただの微分との違い：</p>
<ul>
<li><strong>2次の微小項 <span class="math inline">\((dx)^2\)</span> が消えない</strong></li>
<li>むしろ <span class="math inline">\((dW)^2 = dt\)</span> となって残る</li>
</ul>
<p>これが確率微分の最大のポイント。</p>
<hr>
</section>
<section id="taylor-展開からの導出直感" class="level2">
<h2 class="anchored" data-anchor-id="taylor-展開からの導出直感">4. Taylor 展開からの導出（直感）</h2>
<p>関数 <span class="math inline">\(f(x)\)</span> を <span class="math inline">\(x + dx\)</span> で評価すると：</p>
<p><span class="math inline">\(f(x + dx) = f(x)
\quad + f'(x)\,dx
\quad + \frac{1}{2} f''(x)\,(dx)^2
\quad + \cdots\)</span></p>
<p>通常の微分では <span class="math inline">\((dx)^2\)</span> は無視してよい小ささだが、<br>
確率変数では <strong>無視すると間違いになる</strong>。</p>
<p>なぜか？</p>
<ul>
<li><span class="math inline">\(dx = dW\)</span> の場合<br>
</li>
<li><span class="math inline">\(dW \sim \sqrt{dt}\)</span> の大きさ<br>
</li>
<li><span class="math inline">\((dW)^2 = dt\)</span> は無視できない</li>
</ul>
<hr>
</section>
<section id="実際に計算してみるfxx2" class="level2">
<h2 class="anchored" data-anchor-id="実際に計算してみるfxx2">5. 実際に計算してみる：<span class="math inline">\(f(x)=x^2\)</span></h2>
<section id="関数" class="level3">
<h3 class="anchored" data-anchor-id="関数">関数</h3>
<p><span class="math inline">\(f(x) = x^2\)</span></p>
</section>
<section id="次微分" class="level3">
<h3 class="anchored" data-anchor-id="次微分">1次微分</h3>
<p><span class="math inline">\(f'(x) = 2x\)</span></p>
</section>
<section id="次微分-1" class="level3">
<h3 class="anchored" data-anchor-id="次微分-1">2次微分</h3>
<p><span class="math inline">\(f''(x) = 2\)</span></p>
</section>
<section id="伊藤の補題を適用" class="level3">
<h3 class="anchored" data-anchor-id="伊藤の補題を適用">伊藤の補題を適用</h3>
<p><span class="math inline">\(df = 2x\,dW + \frac{1}{2}\cdot 2 \cdot (dW)^2\)</span></p>
<p><span class="math inline">\(dW^2 = dt\)</span> を使って簡略化：</p>
<p><span class="math inline">\(df = 2x\,dW + dt\)</span></p>
<hr>
</section>
</section>
<section id="普通の微分との比較" class="level2">
<h2 class="anchored" data-anchor-id="普通の微分との比較">6. 普通の微分との比較</h2>
<p>確定変数の場合：</p>
<p><span class="math inline">\(df = 2x\,dx\)</span></p>
<p>確率変数の場合（伊藤の補題）：</p>
<p><span class="math inline">\(df = 2x\,dW + dt\)</span></p>
<p><strong>→ “+ dt” が追加されるのが決定的な違い。</strong></p>
<p>この追加項が後の</p>
<ul>
<li>幾何ブラウン運動（GBM）</li>
<li>Black–Scholes 方程式の導出</li>
<li>金融工学の確率微分方程式</li>
</ul>
<p>すべてに現れる。</p>
<hr>
</section>
<section id="まとめ-3" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-3">7. まとめ</h2>
<ul>
<li>普通の微分では 1次の微小項だけが残る<br>
</li>
<li>ウィーナー過程では <span class="math inline">\((dW)^2 = dt\)</span> が残るため 2次項が重要<br>
</li>
<li>これを体系化したのが <strong>伊藤の補題（Itô’s Lemma）</strong><br>
</li>
<li>金融工学では必須の道具<br>
</li>
<li>次のステップは <strong>幾何ブラウン運動（GBM）に伊藤の補題を適用すること</strong></li>
</ul>
<p>#6-6 高次元伊藤（Itô）計算とブラック–ショールズ方程式の導入</p>
<p>この資料では、講義で説明されていた<br>
<strong>「なぜ確率微分方程式（SDE）と伊藤計算が必要なのか」</strong><br>
を整理しつつ、ブラック–ショールズ式につながる <em>多変数の伊藤補題</em> をまとめる。</p>
<hr>
</section>
<section id="なぜ確率微分方程式sdeが必要なのか" class="level2">
<h2 class="anchored" data-anchor-id="なぜ確率微分方程式sdeが必要なのか">1. なぜ確率微分方程式（SDE）が必要なのか？</h2>
<p>オプション価格 <span class="math inline">\(V(S,t)\)</span> を計算したいとき：</p>
<ul>
<li><p>満期（<span class="math inline">\(t = T\)</span>）ではオプションの価値は明確<br>
例：コールなら <span class="math inline">\(V = \max(S_T - K, 0)\)</span></p></li>
<li><p>しかし知りたいのは <strong>満期前 <span class="math inline">\(t &lt; T\)</span> のオプション価格</strong><br>
→ この時点では株価 <span class="math inline">\(S_t\)</span> が確率的に変動するため、<br>
オプション価格 <span class="math inline">\(V(S,t)\)</span> も確率的に変動する</p></li>
</ul>
<p>よって、株価と同じく <strong>確率過程としてオプション価格を扱う必要がある</strong>。</p>
<p>そのために <strong>確率微分方程式（SDE）</strong> と<br>
<strong>伊藤計算（Itô calculus）</strong> が必要になる。</p>
<hr>
</section>
<section id="株価のモデルsde一次元" class="level2">
<h2 class="anchored" data-anchor-id="株価のモデルsde一次元">2. 株価のモデル：SDE（一次元）</h2>
<p>株価の変化は次の形でモデル化されたとする：</p>
<p>$ dS = a,dt + b,dW $</p>
<ul>
<li><span class="math inline">\(a = \mu S\)</span>（ドリフト：期待成長率）</li>
<li><span class="math inline">\(b = \sigma S\)</span>（ボラティリティ）</li>
</ul>
<p>ただし今回は記号を簡略化して <span class="math inline">\(a, b\)</span> をそのまま使う。</p>
<hr>
</section>
<section id="オプション価格は-2-変数の確率関数-になる" class="level2">
<h2 class="anchored" data-anchor-id="オプション価格は-2-変数の確率関数-になる">3. オプション価格は <strong>2 変数の確率関数</strong> になる</h2>
<p>オプション価格 <span class="math inline">\(V\)</span> は次を変数に持つ：</p>
<ul>
<li>株価：<span class="math inline">\(S\)</span>（確率変数）</li>
<li>時間：<span class="math inline">\(t\)</span>（確定変数）</li>
</ul>
<p>つまり：</p>
<p>$ V = V(S, t) $</p>
<p>変化量は：</p>
<p>$ dV = V_S,dS + V_t,dt + V_{SS}(dS)^2 $</p>
<p>多変数の伊藤の補題（2D Itô’s Lemma）である。</p>
<hr>
</section>
<section id="taylor-展開からの導出のイメージ" class="level2">
<h2 class="anchored" data-anchor-id="taylor-展開からの導出のイメージ">4. Taylor 展開からの導出のイメージ</h2>
<p><span class="math inline">\(V(S,t)\)</span> を <span class="math inline">\((S + dS, t + dt)\)</span> に広げると：</p>
<p>$ V(S+dS, t+dt) =<br>
V + V_S dS + V_t dt + V_{SS}(dS)^2 + $</p>
<p>通常の微分なら <span class="math inline">\((dS)^2\)</span> は無視して良いが、<br>
確率変数では <strong>無視すると間違い</strong>。</p>
<p>理由：<br>
<span class="math inline">\(dS = a\,dt + b\,dW\)</span> なので：</p>
<p><span class="math inline">\((dS)^2 = (a\,dt + b\,dW)^2
\approx b^2(dW)^2 = b^2\,dt\)</span></p>
<p>ここでウィーナー過程の性質：</p>
<p><span class="math inline">\((dW)^2 = dt\)</span></p>
<p>が重要。</p>
<hr>
</section>
<section id="必要な項だけ残すと" class="level2">
<h2 class="anchored" data-anchor-id="必要な項だけ残すと">5. 必要な項だけ残すと…</h2>
<p><span class="math inline">\(dS = a\,dt + b\,dW\)</span> を使って：</p>
<p>$ (dS)^2 b^2 dt $</p>
<p>これを Itô の式に代入：</p>
<p>$ dV<br>
= V_t dt<br>
+ V_S (a,dt + b,dW)<br>
+ V_{SS} b^2 dt $</p>
<p>まとめると：</p>
<p>$ dV<br>
= ( V_t + a V_S + b^2 V_{SS} ) dt<br>
+ b V_S, dW $</p>
<p>これは <strong>オプション価格の確率微分方程式</strong> であり、<br>
後にブラック–ショールズ PDE に変形される。</p>
<hr>
</section>
<section id="なぜこれが重要なのか" class="level2">
<h2 class="anchored" data-anchor-id="なぜこれが重要なのか">6. なぜこれが重要なのか？</h2>
<p>株価 <span class="math inline">\(S\)</span> が確率過程である以上：</p>
<ul>
<li><span class="math inline">\(S\)</span> 依存のオプション価格 <span class="math inline">\(V(S,t)\)</span> も確率過程になる<br>
</li>
<li>よって <span class="math inline">\(V\)</span> の変化量 <span class="math inline">\(dV\)</span> を正しく扱うには<br>
<strong>高次元の伊藤補題</strong> が不可欠</li>
</ul>
<p>ブラック–ショールズの導出では：</p>
<ul>
<li>この式をリスクヘッジ資産に組み合わせることで<br>
</li>
<li><span class="math inline">\(dW\)</span> の項を消し、リスクのないポートフォリオを作り<br>
</li>
<li>PDE（偏微分方程式）へ変形する</li>
</ul>
<p>という流れになる。</p>
<hr>
</section>
<section id="まとめ-4" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-4">7. まとめ</h2>
<ul>
<li>株価が確率過程 → オプション価格も確率過程<br>
</li>
<li>よって 2 変数の伊藤補題が必要<br>
</li>
<li><span class="math inline">\(dV\)</span> には 1次項（<span class="math inline">\(V_S\)</span>, <span class="math inline">\(V_t\)</span>）だけでなく<br>
<strong>2次項の <span class="math inline">\(\frac{1}{2}V_{SS}(dS)^2\)</span> が必須</strong></li>
<li><span class="math inline">\((dS)^2 = b^2 dt\)</span> という性質に注意<br>
</li>
<li>これが後のブラック–ショールズ方程式の核心部分</li>
</ul>
<p>##6-7 幾何ブラウン運動（GBM）の確率微分方程式を伊藤の補題で解く</p>
<p>この資料では、講義で説明されていた<br>
<strong>「幾何ブラウン運動（GBM）の SDE を伊藤の補題で解く手順」</strong><br>
をわかりやすく整理したものです。</p>
<hr>
</section>
<section id="幾何ブラウン運動gbmの定義" class="level2">
<h2 class="anchored" data-anchor-id="幾何ブラウン運動gbmの定義">1. 幾何ブラウン運動（GBM）の定義</h2>
<p>株価 <span class="math inline">\(S(t)\)</span> の変化は次の確率微分方程式（SDE）で与えられる：</p>
<p>$ dS = S,dt + S,dW $</p>
<ul>
<li><span class="math inline">\(\mu\)</span>：ドリフト（平均成長率）</li>
<li><span class="math inline">\(\sigma\)</span>：ボラティリティ</li>
<li><span class="math inline">\(W\)</span>：ウィーナー過程（ブラウン運動）</li>
</ul>
<p>この式を <strong>解いて明示的な形の <span class="math inline">\(S(t)\)</span></strong> を得るのが今回の目的。</p>
<hr>
</section>
<section id="まず式を対数微分の形にする" class="level2">
<h2 class="anchored" data-anchor-id="まず式を対数微分の形にする">2. まず式を「対数微分の形」にする</h2>
<p>両辺を <span class="math inline">\(S\)</span> で割る：</p>
<p>$ = ,dt + ,dW $</p>
<p>これは「対数微分」と同じ形なので：</p>
<p>$ d(S)$ を伊藤の補題で計算すれば良い。</p>
<p>よって、次の関数を定義する：</p>
<ul>
<li><span class="math inline">\(f(S) = \ln S\)</span></li>
</ul>
<hr>
</section>
<section id="伊藤の補題itôs-lemmaを適用" class="level2">
<h2 class="anchored" data-anchor-id="伊藤の補題itôs-lemmaを適用">3. 伊藤の補題（Itô’s Lemma）を適用</h2>
<p>伊藤の補題（1変数版）は：</p>
<p>$ df = f’(S),dS + f’’(S),(dS)^2 $</p>
<p>ここで：</p>
<section id="次微分-2" class="level3">
<h3 class="anchored" data-anchor-id="次微分-2">1次微分</h3>
<p><span class="math inline">\(f'(S) = \frac{1}{S}\)</span></p>
</section>
<section id="次微分-3" class="level3">
<h3 class="anchored" data-anchor-id="次微分-3">2次微分</h3>
<p><span class="math inline">\(f''(S) = -\frac{1}{S^2}\)</span></p>
<hr>
</section>
</section>
<section id="ds2-を計算する" class="level2">
<h2 class="anchored" data-anchor-id="ds2-を計算する">4. <span class="math inline">\((dS)^2\)</span> を計算する</h2>
<p>$ dS = S,dt + S,dW $</p>
<p>の両辺を二乗する：</p>
<p>$(dS)^2<br>
= (S,dt + S,dW)^2<br>
^2 S^2 (dW)^2<br>
= ^2 S^2 dt $</p>
<p>（理由：<span class="math inline">\(dt^2\)</span> や <span class="math inline">\(dt\,dW\)</span> は無視でき、<span class="math inline">\((dW)^2 = dt\)</span> のみ残る）</p>
<hr>
</section>
<section id="伊藤の補題に代入" class="level2">
<h2 class="anchored" data-anchor-id="伊藤の補題に代入">5. 伊藤の補題に代入</h2>
<p><span class="math inline">\(df = f'(S)\,dS + \frac{1}{2}f''(S)(dS)^2\)</span></p>
<p>代入：</p>
<p><span class="math inline">\(df
= \frac{1}{S}(\mu S\,dt + \sigma S\,dW)
\quad + \frac{1}{2}\left(-\frac{1}{S^2}\right)(\sigma^2 S^2 dt)\)</span></p>
<p>簡略化：</p>
<p><span class="math inline">\(df
= \mu\,dt + \sigma\,dW
\quad - \frac{1}{2}\sigma^2 dt\)</span></p>
<p>よって：</p>
<p>$ d(S)<br>
= (- ^2) dt + , dW $</p>
<hr>
</section>
<section id="両辺を積分して明示解を得る" class="level2">
<h2 class="anchored" data-anchor-id="両辺を積分して明示解を得る">6. 両辺を積分して明示解を得る</h2>
<p>0〜t まで積分：</p>
<p><span class="math inline">\(\ln S(t) - \ln S(0)
= \left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W(t)\)</span></p>
<p>両辺に指数をつけて <span class="math inline">\(S(t)\)</span> を求める：</p>
<p>$ S(t)<br>
= S(0),$</p>
<hr>
</section>
<section id="幾何ブラウン運動の解の特徴" class="level2">
<h2 class="anchored" data-anchor-id="幾何ブラウン運動の解の特徴">7. 幾何ブラウン運動の解の特徴</h2>
<ul>
<li><strong>常に正の値をとる</strong>（指数関数形のため）</li>
<li><strong>平均成長率 <span class="math inline">\(\mu\)</span> に従って長期的に増えていく</strong></li>
<li><strong>ボラティリティ <span class="math inline">\(\sigma\)</span> が大きいほど変動も大きい</strong></li>
<li><strong>株価の現実的特徴を非常によく表す</strong></li>
</ul>
<p>→ この理由で <strong>GBM は現代金融工学の標準的な株価モデル</strong> になっている。</p>
<hr>
</section>
<section id="まとめ-5" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-5">8. まとめ</h2>
<ul>
<li>SDE <span class="math inline">\(dS=\mu S dt + \sigma S dW\)</span> を伊藤の補題で解いた<br>
</li>
<li>対数変換 <span class="math inline">\(f(S)=\ln S\)</span> を使うのがポイント<br>
</li>
<li><span class="math inline">\((dW)^2 = dt\)</span> を利用して 2次項が残る<br>
</li>
<li>最終解は：</li>
</ul>
<p>$ S(t) = S(0)$</p>
<ul>
<li>これが次の講義でシミュレーションする <strong>GBM の明示解</strong> となる</li>
</ul>
<p>##6-8 幾何ブラウン運動（GBM）のPython実装</p>
<p>この資料では、講義で説明されていた<br>
<strong>「幾何ブラウン運動（Geometric Brownian Motion: GBM）のシミュレーション」</strong><br>
を、数式の復習から Python 実装まで整理してまとめる。</p>
<hr>
</section>
<section id="幾何ブラウン運動の復習" class="level2">
<h2 class="anchored" data-anchor-id="幾何ブラウン運動の復習">1. 幾何ブラウン運動の復習</h2>
<p>前の講義で学んだ GBM の確率微分方程式（SDE）は：</p>
<p>$ dS = S,dt + S,dW $</p>
<p>この式の解（明示解）は：</p>
<p>$ S(t) = S_0 $</p>
<p>したがって、Python では</p>
<ul>
<li><span class="math inline">\(W(t)\)</span> を Brownian motion（累積和）</li>
<li>その結果を上式に代入</li>
</ul>
<p>することで株価パスを生成できる。</p>
<hr>
</section>
<section id="gbm-シミュレーションのアルゴリズム" class="level2">
<h2 class="anchored" data-anchor-id="gbm-シミュレーションのアルゴリズム">2. GBM シミュレーションのアルゴリズム</h2>
<ol type="1">
<li>時間刻み<br>
<span class="math inline">\(dt = T/N\)</span> を計算する<br>
</li>
<li>時間軸<br>
<code>np.linspace(0, T, N+1)</code><br>
</li>
<li>標準正規乱数を生成<br>
<span class="math inline">\(Z \sim N(0,1)\)</span><br>
</li>
<li><span class="math inline">\(W(t)\)</span> を累積和で生成<br>
<span class="math inline">\(W(t) = \sqrt{dt} \sum Z\)</span><br>
</li>
<li>明示解<br>
<span class="math inline">\(S(t) = S_0 \exp[(\mu - \tfrac12\sigma^2)t + \sigma W(t)]\)</span></li>
</ol>
<hr>
</section>
<section id="python-コード幾何ブラウン運動gbmの実装" class="level2">
<h2 class="anchored" data-anchor-id="python-コード幾何ブラウン運動gbmの実装">3. Python コード：幾何ブラウン運動（GBM）の実装</h2>
<p>以下は講義内容に基づいた <strong>シンプルで本格的な実装</strong>。</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_gbm(S0, T, N, mu, sigma):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    幾何ブラウン運動 (GBM) のシミュレーション</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    S0   : 初期株価</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    T    : シミュレーション期間（年）</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    N    : ステップ数</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">    mu   : ドリフト（平均成長率）</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    sigma: ボラティリティ</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. 時間刻み</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> T <span class="op">/</span> N</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. 時間軸</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, T, N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. 標準正規乱数</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, N)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Brownian motion</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    W <span class="op">=</span> np.zeros(N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    W[<span class="dv">1</span>:] <span class="op">=</span> np.cumsum(np.sqrt(dt) <span class="op">*</span> Z)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5. GBM の明示解</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> S0 <span class="op">*</span> np.exp((mu <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> t <span class="op">+</span> sigma <span class="op">*</span> W)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> t, S</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_gbm(t, S):</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, S, label<span class="op">=</span><span class="st">"Geometric Brownian Motion"</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Stock Price"</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"GBM Simulation"</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co"># メイン処理例</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    S0 <span class="op">=</span> <span class="dv">10</span>       <span class="co"># 初期株価</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="dv">2</span>         <span class="co"># 2年間</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="dv">1000</span>      <span class="co"># 1000ステップ</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> <span class="fl">0.1</span>      <span class="co"># 平均成長率（10%）</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> <span class="fl">0.3</span>   <span class="co"># ボラティリティ</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    t, S <span class="op">=</span> simulate_gbm(S0, T, N, mu, sigma)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    plot_gbm(t, S)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="出力される株価軌道の特徴" class="level2">
<h2 class="anchored" data-anchor-id="出力される株価軌道の特徴">4. 出力される株価軌道の特徴</h2>
<p>シミュレーション結果を確認すると：</p>
<ul>
<li><strong>上昇トレンド（μによる）</strong></li>
<li><strong>ランダム変動（σによる）</strong></li>
<li><strong>価格は常に 0 より大きい</strong> → 株価の性質に合致<br>
</li>
<li><strong>σ を大きくすると変動が大きくなる</strong></li>
<li><strong>S0 を変えると開始点が変わる</strong></li>
</ul>
<p>たとえば：</p>
<ul>
<li><code>sigma = 0.05</code> → 滑らかで安定<br>
</li>
<li><code>sigma = 0.5</code> → 激しく上下に揺れる</li>
</ul>
<hr>
</section>
<section id="このモデルが株価に適している理由" class="level2">
<h2 class="anchored" data-anchor-id="このモデルが株価に適している理由">5. このモデルが株価に適している理由</h2>
<p>幾何ブラウン運動 GBM は株価の性質を自然に再現する：</p>
<ul>
<li><strong>負の値を取らない（下限が 0）</strong></li>
<li><strong>長期的に増加する傾向（経済成長）</strong></li>
<li><strong>価格が大きいと変動幅も大きくなる（対数正規性）</strong></li>
<li><strong>金融工学で最も広く使われる標準モデル</strong></li>
</ul>
<p>（Black–Scholes 価格公式も GBM を前提に導かれる）</p>
<hr>
</section>
<section id="まとめ-6" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-6">6. まとめ</h2>
<ul>
<li>GBM の SDE：<span class="math inline">\(dS = \mu S dt + \sigma S dW\)</span><br>
</li>
<li>伊藤の補題で解くと明示式が得られる<br>
</li>
<li>Brownian motion を累積和で生成し、指数に代入するだけでシミュレーション可能<br>
</li>
<li>Python では NumPy を使って効率的に実装できる<br>
</li>
<li>株価の現実的特徴（対数正規性・非負性）を自然に満たす</li>
</ul>
<div id="cell-10" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.random <span class="im">as</span> npr</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  ウィーナー過程クラス</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WienerProcess:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dt<span class="op">=</span><span class="fl">0.1</span>, N<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">        初期化</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">        dt : 時間刻み</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">        N  : ステップ数</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dt <span class="op">=</span> dt</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.N <span class="op">=</span> N</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.t <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_path(<span class="va">self</span>):</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""ウィーナー過程 W(t) を生成して内部に保持する"""</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 時間軸</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="va">self</span>.N <span class="op">*</span> <span class="va">self</span>.dt, <span class="va">self</span>.N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 標準正規乱数 Z ~ N(0, 1)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> npr.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="va">self</span>.N)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 増分 dW = sqrt(dt) * Z</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        dW <span class="op">=</span> np.sqrt(<span class="va">self</span>.dt) <span class="op">*</span> Z</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 初期値 0 の配列</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W <span class="op">=</span> np.zeros(<span class="va">self</span>.N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 累積和で W を構築</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.W[<span class="dv">1</span>:] <span class="op">=</span> np.cumsum(dW)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.t, <span class="va">self</span>.W</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_path(<span class="va">self</span>):</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""生成されたパスをプロットする"""</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.W <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.generate_path()</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.t, <span class="va">self</span>.W, label<span class="op">=</span><span class="st">"Wiener Process"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">"W(t)"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">"Wiener Process Simulation"</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        plt.legend()</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">#  幾何ブラウン運動 (GBM)</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_gbm(S0, T, N, mu, sigma):</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">    幾何ブラウン運動 (GBM) のシミュレーション</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">    S0   : 初期株価</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="co">    T    : シミュレーション期間（年）</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="co">    N    : ステップ数</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="co">    mu   : ドリフト（平均成長率）</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="co">    sigma: ボラティリティ</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. 時間刻み</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> T <span class="op">/</span> N</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. 時間軸</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, T, N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. 標準正規乱数</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, N)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Brownian motion</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    W <span class="op">=</span> np.zeros(N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    W[<span class="dv">1</span>:] <span class="op">=</span> np.cumsum(np.sqrt(dt) <span class="op">*</span> Z)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5. GBM の明示解</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> S0 <span class="op">*</span> np.exp((mu <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> t <span class="op">+</span> sigma <span class="op">*</span> W)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> t, S</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_gbm(t, S):</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, S, label<span class="op">=</span><span class="st">"Geometric Brownian Motion"</span>)</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Stock Price"</span>)</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"GBM Simulation"</span>)</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="co">#  メイン処理（ノートブックではそのまま実行）</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="co"># =========================</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ウィーナー過程</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    process <span class="op">=</span> WienerProcess(dt<span class="op">=</span><span class="fl">0.1</span>, N<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>    process.plot_path()</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GBM</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>    S0 <span class="op">=</span> <span class="dv">10</span>       <span class="co"># 初期株価</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="dv">2</span>         <span class="co"># 2年間</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="dv">1000</span>      <span class="co"># 1000ステップ</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> <span class="fl">0.1</span>      <span class="co"># 平均成長率（10%）</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> <span class="fl">0.3</span>   <span class="co"># ボラティリティ</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    t, S <span class="op">=</span> simulate_gbm(S0, T, N, mu, sigma)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    plot_gbm(t, S)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cdos – 金融工学ノート</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">金融工学ノート</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">ホーム</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./03-portfolio.html"> 
<span class="menu-text">ポートフォリオ理論</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./04-capm.qmd"> 
<span class="menu-text">CAPM</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cdo-の誕生と拡大" id="toc-cdo-の誕生と拡大" class="nav-link active" data-scroll-target="#cdo-の誕生と拡大">1. CDO の誕生と拡大</a></li>
  <li><a href="#cdo-の中身何が束ねられている" id="toc-cdo-の中身何が束ねられている" class="nav-link" data-scroll-target="#cdo-の中身何が束ねられている">2. CDO の中身：何が束ねられている？</a></li>
  <li><a href="#cdo-がどのように作られるか" id="toc-cdo-がどのように作られるか" class="nav-link" data-scroll-target="#cdo-がどのように作られるか">3. CDO がどのように作られるか</a>
  <ul class="collapse">
  <li><a href="#step-1商業銀行がローンを発行" id="toc-step-1商業銀行がローンを発行" class="nav-link" data-scroll-target="#step-1商業銀行がローンを発行">Step 1：商業銀行がローンを発行</a></li>
  <li><a href="#step-2投資銀行がローンをまとめて買い取る" id="toc-step-2投資銀行がローンをまとめて買い取る" class="nav-link" data-scroll-target="#step-2投資銀行がローンをまとめて買い取る">Step 2：投資銀行がローンをまとめて買い取る</a></li>
  <li><a href="#step-3投資銀行がローンを再パッケージ化し-cdo-を作る" id="toc-step-3投資銀行がローンを再パッケージ化し-cdo-を作る" class="nav-link" data-scroll-target="#step-3投資銀行がローンを再パッケージ化し-cdo-を作る">Step 3：投資銀行がローンを「再パッケージ化」し CDO を作る</a></li>
  <li><a href="#step-4投資家に販売" id="toc-step-4投資家に販売" class="nav-link" data-scroll-target="#step-4投資家に販売">Step 4：投資家に販売</a></li>
  </ul></li>
  <li><a href="#cdo-が危険と言われる理由" id="toc-cdo-が危険と言われる理由" class="nav-link" data-scroll-target="#cdo-が危険と言われる理由">4. CDO が危険と言われる理由</a></li>
  <li><a href="#本章の方向性" id="toc-本章の方向性" class="nav-link" data-scroll-target="#本章の方向性">5. 本章の方向性</a></li>
  <li><a href="#cdo-はローンの束プールでできている" id="toc-cdo-はローンの束プールでできている" class="nav-link" data-scroll-target="#cdo-はローンの束プールでできている">1. CDO はローンの束（プール）でできている</a></li>
  <li><a href="#ローンにはデフォルト確率がある" id="toc-ローンにはデフォルト確率がある" class="nav-link" data-scroll-target="#ローンにはデフォルト確率がある">2. ローンには「デフォルト確率」がある</a></li>
  <li><a href="#分散の基本原理相関の低い資産を混ぜると安全になる" id="toc-分散の基本原理相関の低い資産を混ぜると安全になる" class="nav-link" data-scroll-target="#分散の基本原理相関の低い資産を混ぜると安全になる">3. 分散の基本原理：<strong>相関の低い資産を混ぜると安全になる</strong></a>
  <ul class="collapse">
  <li><a href="#例良い-cdo" id="toc-例良い-cdo" class="nav-link" data-scroll-target="#例良い-cdo">例（良い CDO）</a></li>
  </ul></li>
  <li><a href="#相関が高いと分散は崩壊する" id="toc-相関が高いと分散は崩壊する" class="nav-link" data-scroll-target="#相関が高いと分散は崩壊する">4. 相関が高いと分散は崩壊する</a>
  <ul class="collapse">
  <li><a href="#多くの-cdo-は実際こうだった" id="toc-多くの-cdo-は実際こうだった" class="nav-link" data-scroll-target="#多くの-cdo-は実際こうだった">多くの CDO は実際こうだった</a></li>
  </ul></li>
  <li><a href="#危機の核心" id="toc-危機の核心" class="nav-link" data-scroll-target="#危機の核心">5. 2007–2008危機の核心</a></li>
  <li><a href="#まとめ" id="toc-まとめ" class="nav-link" data-scroll-target="#まとめ">6.まとめ</a></li>
  <li><a href="#cdo-は3つの層に分かれている" id="toc-cdo-は3つの層に分かれている" class="nav-link" data-scroll-target="#cdo-は3つの層に分かれている">1. CDO は「3つの層」に分かれている</a></li>
  <li><a href="#senior-trancheシニア層" id="toc-senior-trancheシニア層" class="nav-link" data-scroll-target="#senior-trancheシニア層">2. Senior Tranche（シニア層）</a>
  <ul class="collapse">
  <li><a href="#理由" id="toc-理由" class="nav-link" data-scroll-target="#理由">理由：</a></li>
  </ul></li>
  <li><a href="#junior-mezzanine-trancheジュニア層" id="toc-junior-mezzanine-trancheジュニア層" class="nav-link" data-scroll-target="#junior-mezzanine-trancheジュニア層">3. Junior / Mezzanine Tranche（ジュニア層）</a>
  <ul class="collapse">
  <li><a href="#特徴" id="toc-特徴" class="nav-link" data-scroll-target="#特徴">特徴</a></li>
  </ul></li>
  <li><a href="#equityエクイティtranche" id="toc-equityエクイティtranche" class="nav-link" data-scroll-target="#equityエクイティtranche">4. Equity（エクイティ）Tranche</a>
  <ul class="collapse">
  <li><a href="#特徴-1" id="toc-特徴-1" class="nav-link" data-scroll-target="#特徴-1">特徴</a></li>
  </ul></li>
  <li><a href="#トランシェの仕組みキャッシュフローの流れ" id="toc-トランシェの仕組みキャッシュフローの流れ" class="nav-link" data-scroll-target="#トランシェの仕組みキャッシュフローの流れ">5. トランシェの仕組み（キャッシュフローの流れ）</a></li>
  <li><a href="#投資家はどれを買うべき" id="toc-投資家はどれを買うべき" class="nav-link" data-scroll-target="#投資家はどれを買うべき">6. 投資家はどれを買うべき？</a></li>
  <li><a href="#なぜこれが問題になったのか" id="toc-なぜこれが問題になったのか" class="nav-link" data-scroll-target="#なぜこれが問題になったのか">7. なぜこれが問題になったのか？</a></li>
  <li><a href="#危機前すべてが順調だった" id="toc-危機前すべてが順調だった" class="nav-link" data-scroll-target="#危機前すべてが順調だった">1. 危機前：すべてが順調だった</a></li>
  <li><a href="#問題もっとローンが必要になった" id="toc-問題もっとローンが必要になった" class="nav-link" data-scroll-target="#問題もっとローンが必要になった">2. 問題：もっとローンが必要になった</a>
  <ul class="collapse">
  <li><a href="#サブプライムとは" id="toc-サブプライムとは" class="nav-link" data-scroll-target="#サブプライムとは">サブプライムとは？</a></li>
  </ul></li>
  <li><a href="#なぜ銀行はリスクを無視したのか" id="toc-なぜ銀行はリスクを無視したのか" class="nav-link" data-scroll-target="#なぜ銀行はリスクを無視したのか">3. なぜ銀行はリスクを無視したのか？</a>
  <ul class="collapse">
  <li><a href="#住宅価格はずっと上がると信じられていた" id="toc-住宅価格はずっと上がると信じられていた" class="nav-link" data-scroll-target="#住宅価格はずっと上がると信じられていた">✔ 住宅価格はずっと上がると信じられていた</a></li>
  <li><a href="#ローンは投資銀行へ売却できる" id="toc-ローンは投資銀行へ売却できる" class="nav-link" data-scroll-target="#ローンは投資銀行へ売却できる">✔ ローンは投資銀行へ売却できる</a></li>
  </ul></li>
  <li><a href="#cdo-が危険化した-2-つの理由" id="toc-cdo-が危険化した-2-つの理由" class="nav-link" data-scroll-target="#cdo-が危険化した-2-つの理由">4. CDO が危険化した 2 つの理由</a>
  <ul class="collapse">
  <li><a href="#サブプライムローンの大量発生-デフォルト確率の爆増" id="toc-サブプライムローンの大量発生-デフォルト確率の爆増" class="nav-link" data-scroll-target="#サブプライムローンの大量発生-デフォルト確率の爆増">① サブプライムローンの大量発生 → <strong>デフォルト確率の爆増</strong></a></li>
  <li><a href="#cdo-が同じ種類のローンばかりに偏った" id="toc-cdo-が同じ種類のローンばかりに偏った" class="nav-link" data-scroll-target="#cdo-が同じ種類のローンばかりに偏った">② CDO が「同じ種類のローン」ばかりに偏った</a></li>
  </ul></li>
  <li><a href="#投資家に何が起きたか" id="toc-投資家に何が起きたか" class="nav-link" data-scroll-target="#投資家に何が起きたか">5. 投資家に何が起きたか？</a></li>
  <li><a href="#システム全体が凍結credit-crunch" id="toc-システム全体が凍結credit-crunch" class="nav-link" data-scroll-target="#システム全体が凍結credit-crunch">6. システム全体が凍結（Credit Crunch）</a></li>
  <li><a href="#そして-2008-年大崩壊へ" id="toc-そして-2008-年大崩壊へ" class="nav-link" data-scroll-target="#そして-2008-年大崩壊へ">7. そして 2008 年、大崩壊へ</a></li>
  <li><a href="#まとめ-1" id="toc-まとめ-1" class="nav-link" data-scroll-target="#まとめ-1">まとめ</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<p><a href="https://colab.research.google.com/github/ish66726-a11y/colab-notebooks/blob/main/VaR%2CCDO%2C%E9%87%91%E5%88%A9%E3%83%A2%E3%83%87%E3%83%AB%2CVasicek%E3%83%A2%E3%83%87%E3%83%AB%2C%E9%95%B7%E6%9C%9F%E6%8A%95%E8%B3%87.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<p>#Collateralized Debt Obligations(CDOs)</p>
<p>##9-1 Collateralized Debt Obligations（CDO）とは何か？<br>
2007–2008年の金融危機を引き起こした中心的存在となった金融商品</p>
<hr>
<section id="cdo-の誕生と拡大" class="level2">
<h2 class="anchored" data-anchor-id="cdo-の誕生と拡大">1. CDO の誕生と拡大</h2>
<ul>
<li><strong>誕生</strong>：1987年<br>
</li>
<li><strong>10年以内に</strong>：デリバティブ市場の主要商品へ成長<br>
</li>
<li><strong>本質</strong>：<br>
→ <em>複数のローン（債権）を束ねることで作られた複雑な金融商品</em></li>
</ul>
<p>ウォーレン・バフェット曰く：<br>
&gt; “CDOs and other credit derivatives are financial weapons of mass destruction.”<br>
（CDO などの信用派生商品は金融破壊兵器である）</p>
<p>理由：<br>
内容の把握が極めて難しく、数学的にも不透明性が高い。</p>
<hr>
</section>
<section id="cdo-の中身何が束ねられている" class="level2">
<h2 class="anchored" data-anchor-id="cdo-の中身何が束ねられている">2. CDO の中身：何が束ねられている？</h2>
<p>典型的には <strong>商業銀行が保有するローン（債務）</strong> が材料となる：</p>
<ul>
<li><p><strong>学生ローン</strong><br>
→ 米国では 65% が借入、卒業時平均 $30,000 の債務</p></li>
<li><p><strong>クレジットカードローン</strong><br>
→ 平均負債 約 $6,000</p></li>
<li><p><strong>住宅ローン（Mortgage）</strong><br>
→ 全米の約 60% が住宅ローンを保有</p></li>
<li><p><strong>自動車ローン</strong><br>
→ 約 1億件のアカウントが存在</p></li>
</ul>
<p>銀行はこれらのローンを保有しているが…</p>
<hr>
</section>
<section id="cdo-がどのように作られるか" class="level2">
<h2 class="anchored" data-anchor-id="cdo-がどのように作られるか">3. CDO がどのように作られるか</h2>
<section id="step-1商業銀行がローンを発行" class="level3">
<h3 class="anchored" data-anchor-id="step-1商業銀行がローンを発行">Step 1：商業銀行がローンを発行</h3>
<p>学生ローン・住宅ローン・カードローン・自動車ローンなど。</p>
</section>
<section id="step-2投資銀行がローンをまとめて買い取る" class="level3">
<h3 class="anchored" data-anchor-id="step-2投資銀行がローンをまとめて買い取る">Step 2：投資銀行がローンをまとめて買い取る</h3>
<p>例：<br>
- JPMorgan<br>
- Goldman Sachs<br>
- Deutsche Bank<br>
- Citigroup<br>
- Morgan Stanley<br>
など。</p>
</section>
<section id="step-3投資銀行がローンを再パッケージ化し-cdo-を作る" class="level3">
<h3 class="anchored" data-anchor-id="step-3投資銀行がローンを再パッケージ化し-cdo-を作る">Step 3：投資銀行がローンを「再パッケージ化」し CDO を作る</h3>
<p>ローンを束ねて 1つの金融商品に変換。</p>
</section>
<section id="step-4投資家に販売" class="level3">
<h3 class="anchored" data-anchor-id="step-4投資家に販売">Step 4：投資家に販売</h3>
<p>投資家は <strong>国債や社債より高いリターン</strong> が得られると信じて CDO を購入した。</p>
<hr>
</section>
</section>
<section id="cdo-が危険と言われる理由" class="level2">
<h2 class="anchored" data-anchor-id="cdo-が危険と言われる理由">4. CDO が危険と言われる理由</h2>
<ul>
<li>多数のローンを束ねているため <strong>依存関係・相関の計算が極めて難しい</strong></li>
<li>数理モデルが複雑で、内容を理解できる人が少ない</li>
<li>リスクが過小評価されやすい構造</li>
</ul>
<hr>
</section>
<section id="本章の方向性" class="level2">
<h2 class="anchored" data-anchor-id="本章の方向性">5. 本章の方向性</h2>
<p>この章では、</p>
<ol type="1">
<li><strong>CDO の仕組み</strong><br>
</li>
<li><strong>トランシェ構造</strong><br>
</li>
<li><strong>信用リスクと相関の問題</strong><br>
</li>
<li><strong>サブプライム危機との接続</strong><br>
</li>
<li><strong>数理モデル（ガウスコピュラモデルなど）</strong></li>
</ol>
<p>を順番に解説していく。</p>
<p>##9-2 CDO と「分散（Diversification）」の重要性 本章では、CDO においてなぜ <strong>分散（Diversification）</strong> が重要なのかを解説する。</p>
<hr>
</section>
<section id="cdo-はローンの束プールでできている" class="level2">
<h2 class="anchored" data-anchor-id="cdo-はローンの束プールでできている">1. CDO はローンの束（プール）でできている</h2>
<p>商業銀行が発行するさまざまなローン：</p>
<ul>
<li>学生ローン<br>
</li>
<li>クレジットカードローン<br>
</li>
<li>自動車ローン<br>
</li>
<li>住宅ローン（Mortgage）</li>
</ul>
<p>これらは投資銀行に売却され、その後 CDO に再構成される。</p>
<p><strong>ポイント：</strong><br>
ローンの返済（毎月の支払い）は、もはや銀行ではなく <strong>CDO 保有者が受け取る</strong>。</p>
<hr>
</section>
<section id="ローンにはデフォルト確率がある" class="level2">
<h2 class="anchored" data-anchor-id="ローンにはデフォルト確率がある">2. ローンには「デフォルト確率」がある</h2>
<p>どのローンにも、</p>
<ul>
<li><strong>返済できなくなるリスク（デフォルト）</strong></li>
</ul>
<p>が存在する。</p>
<p>→ しかし通常は <strong>デフォルト確率はかなり低い</strong><br>
→ だからこそ “分散すれば安全になる” と考えられていた。</p>
<hr>
</section>
<section id="分散の基本原理相関の低い資産を混ぜると安全になる" class="level2">
<h2 class="anchored" data-anchor-id="分散の基本原理相関の低い資産を混ぜると安全になる">3. 分散の基本原理：<strong>相関の低い資産を混ぜると安全になる</strong></h2>
<p>モダンポートフォリオ理論（Markowitz）と同じく：</p>
<blockquote class="blockquote">
<p><strong>相関が低い（ほぼ無関係な）資産を組み合わせるとリスクが下がる</strong></p>
</blockquote>
<section id="例良い-cdo" class="level3">
<h3 class="anchored" data-anchor-id="例良い-cdo">例（良い CDO）</h3>
<pre><code>[Mortgage]    [Car Loan]    [Student Loan]
     │              │               │
相関 ≈ 0      相関 ≈ 0        相関 ≈ 0</code></pre>
<p>このように <strong>異なる種類のローンを混ぜれば</strong>、<br>
同時に全員が返済不能になる可能性は極めて低くなる。</p>
<p>→ <strong>リスクが大幅に減り、安全な CDO が完成する。</strong></p>
<hr>
</section>
</section>
<section id="相関が高いと分散は崩壊する" class="level2">
<h2 class="anchored" data-anchor-id="相関が高いと分散は崩壊する">4. 相関が高いと分散は崩壊する</h2>
<p>問題はここ。</p>
<section id="多くの-cdo-は実際こうだった" class="level3">
<h3 class="anchored" data-anchor-id="多くの-cdo-は実際こうだった">多くの CDO は実際こうだった</h3>
<pre><code>[Mortgage]  [Mortgage]  [Mortgage]  [Mortgage]  [Mortgage]
     │          │          │           │           │
  高い相関   高い相関   高い相関   高い相関    高い相関</code></pre>
<p>ほぼ <strong>全部が住宅ローン（特にサブプライム）</strong> だった。</p>
<p>住宅市場が下落すると…</p>
<blockquote class="blockquote">
<p><strong>すべてのローンが同時に破綻する<br>
→ CDO全体が大爆発する</strong></p>
</blockquote>
<p>という事態が発生。</p>
<p>これは「分散」が完全に失敗する典型例。</p>
<hr>
</section>
</section>
<section id="危機の核心" class="level2">
<h2 class="anchored" data-anchor-id="危機の核心">5. 2007–2008危機の核心</h2>
<p>CDO の中身が住宅ローンに偏りすぎていたため：</p>
<ul>
<li>見かけ上は「安全に見える」<br>
</li>
<li>実際は <strong>相関100%に近い爆弾</strong></li>
</ul>
<p>だった。</p>
<p>→ <strong>住宅価格が下がった瞬間にシステムが連鎖崩壊した。</strong></p>
<hr>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">6.まとめ</h2>
<ul>
<li>CDO の安全性は <strong>内部の資産がどれだけ相関しているか</strong> に依存する<br>
</li>
<li>異種ローン（学生・自動車・カード）は本来相関が低い → 安全<br>
</li>
<li>2007–2008危機の CDO は <strong>住宅ローンに偏りすぎていた</strong><br>
</li>
<li>相関が高いと分散は機能しない<br>
</li>
<li>「分散したつもり」が最大のリスクになる</li>
</ul>
<p>##9-3 CDO のトランシェ構造（Senior / Junior / Equity）</p>
<p>前章では、銀行が発行したローンを投資銀行がまとめて CDO を作る仕組みを学んだ。<br>
しかし <strong>CDO は単なるローンの束ではなく、内部が “トランシェ（層構造）” に分けられている。</strong></p>
<p>本章では、その中身を詳しく解説する。</p>
<hr>
</section>
<section id="cdo-は3つの層に分かれている" class="level2">
<h2 class="anchored" data-anchor-id="cdo-は3つの層に分かれている">1. CDO は「3つの層」に分かれている</h2>
<p>CDO はリスクとリターンに応じて <strong>3階建ての構造</strong> になっている：</p>
<pre><code> ┌───────────────────────┐
 │   Senior Tranche（AA A）  ← 最も安全・低利回り   │
 ├───────────────────────┤
 │   Junior / Mezzanine（BBB）  ← 中程度のリスク     │
 ├───────────────────────┤
 │   Equity / Equity Tranche  ← 最も危険・高利回り │
 └───────────────────────┘</code></pre>
<hr>
</section>
<section id="senior-trancheシニア層" class="level2">
<h2 class="anchored" data-anchor-id="senior-trancheシニア層">2. Senior Tranche（シニア層）</h2>
<ul>
<li><strong>最も安全</strong></li>
<li><strong>AAA 評価</strong>（S&amp;P / Moody’s）</li>
<li><strong>利回り：4% 前後（低い）</strong></li>
<li><strong>ローン返済（キャッシュフロー）を最優先で受け取る</strong></li>
</ul>
<section id="理由" class="level3">
<h3 class="anchored" data-anchor-id="理由">理由：</h3>
<p>ローンの支払いは <strong>まずシニア層へ</strong> → その後で他の層に回される<br>
➡ <strong>損失が発生しても影響を受けにくい</strong></p>
<hr>
</section>
</section>
<section id="junior-mezzanine-trancheジュニア層" class="level2">
<h2 class="anchored" data-anchor-id="junior-mezzanine-trancheジュニア層">3. Junior / Mezzanine Tranche（ジュニア層）</h2>
<ul>
<li><strong>中程度のリスク</strong></li>
<li><strong>BBB 評価</strong></li>
<li><strong>利回り：7% 前後（中くらい）</strong></li>
<li>支払いは <strong>シニア層の後に受け取る</strong></li>
</ul>
<section id="特徴" class="level3">
<h3 class="anchored" data-anchor-id="特徴">特徴</h3>
<ul>
<li>シニアよりリスクは高いが、まだ「比較的安全」と信じられていた<br>
</li>
<li>2007–2008年危機では <strong>ここが大量に破綻</strong> した</li>
</ul>
<hr>
</section>
</section>
<section id="equityエクイティtranche" class="level2">
<h2 class="anchored" data-anchor-id="equityエクイティtranche">4. Equity（エクイティ）Tranche</h2>
<ul>
<li><strong>最も危険</strong></li>
<li><strong>無格付または非常に低格付</strong></li>
<li><strong>利回り：10% 以上の高利回り</strong></li>
<li>支払いは <strong>最後</strong><br>
</li>
<li>損失は <strong>最初にここが吸収する</strong></li>
</ul>
<section id="特徴-1" class="level3">
<h3 class="anchored" data-anchor-id="特徴-1">特徴</h3>
<ul>
<li>典型的に <strong>ヘッジファンド</strong> が購入<br>
</li>
<li>超高リスク・高リターン</li>
</ul>
<hr>
</section>
</section>
<section id="トランシェの仕組みキャッシュフローの流れ" class="level2">
<h2 class="anchored" data-anchor-id="トランシェの仕組みキャッシュフローの流れ">5. トランシェの仕組み（キャッシュフローの流れ）</h2>
<pre><code>ローンの返済（キャッシュフロー）
        ↓
[① Senior に優先的に支払う]
        ↓
[② 残りが Junior に支払われる]
        ↓
[③ 最後に Equity へ]</code></pre>
<p>損失が出た場合の吸収順序（ウォーターフォール方式）：</p>
<pre><code>損失はまず Equity が吸収  
→ 次に Junior  
→ 最後に Senior</code></pre>
<p>だから <strong>安全性と利回りが反比例</strong> する。</p>
<hr>
</section>
<section id="投資家はどれを買うべき" class="level2">
<h2 class="anchored" data-anchor-id="投資家はどれを買うべき">6. 投資家はどれを買うべき？</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tranche</th>
<th>リスク</th>
<th>リターン</th>
<th>主な購入者</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Senior (AAA)</td>
<td>低</td>
<td>4%</td>
<td>保守的な投資家、年金、保険会社</td>
</tr>
<tr class="even">
<td>Junior (BBB)</td>
<td>中</td>
<td>7%</td>
<td>バランス型ファンド</td>
</tr>
<tr class="odd">
<td>Equity</td>
<td>高</td>
<td>10%+</td>
<td>ヘッジファンド</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="なぜこれが問題になったのか" class="level2">
<h2 class="anchored" data-anchor-id="なぜこれが問題になったのか">7. なぜこれが問題になったのか？</h2>
<p>2007–2008危機では：</p>
<ul>
<li>格付機関が <strong>過剰に AAA を付けた</strong></li>
<li>実際は <strong>同じ種類の資産（住宅ローン）ばかり</strong>で相関が高すぎた</li>
<li>Junior と Equity が連鎖的に破綻<br>
</li>
<li>最後は Senior すら影響を受ける巨大崩壊に</li>
</ul>
<p>##9-4 サブプライム危機（2007–2008）と CDO 崩壊のメカニズム</p>
<p>前章では CDO（Collateralized Debt Obligation）の仕組みを理解した。<br>
しかし 2007–2008 年の金融危機では、この CDO が「爆心地」となった。</p>
<p>この章では、なぜ CDO が破綻し、世界的な金融危機を引き起こしたのかを整理する。</p>
<hr>
</section>
<section id="危機前すべてが順調だった" class="level2">
<h2 class="anchored" data-anchor-id="危機前すべてが順調だった">1. 危機前：すべてが順調だった</h2>
<p>2000 年代初頭、CDO システムは完全に機能していた。</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>参加者</th>
<th>得していた理由</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>商業銀行</strong></td>
<td>住宅ローン・学生ローン・自動車ローンなどを <strong>投資銀行へ売却</strong>し利益を得る</td>
</tr>
<tr class="even">
<td><strong>投資銀行</strong></td>
<td>ローンを束ねて CDO を作り、投資家へ売却して大きな利益</td>
</tr>
<tr class="odd">
<td><strong>投資家</strong></td>
<td>シニア 4%、ジュニア 7%、エクイティ 10% など <strong>高い利回り</strong>を得る</td>
</tr>
</tbody>
</table>
<p>すべてが「Win-Win」のように見えた。</p>
<hr>
</section>
<section id="問題もっとローンが必要になった" class="level2">
<h2 class="anchored" data-anchor-id="問題もっとローンが必要になった">2. 問題：もっとローンが必要になった</h2>
<p>CDO は大量のローンを必要とするため、<br>
<strong>銀行はローンの基準をどんどん緩くした。</strong></p>
<p>その結果生まれたのが <strong>サブプライムローン（Subprime Mortgage）</strong>。</p>
<section id="サブプライムとは" class="level3">
<h3 class="anchored" data-anchor-id="サブプライムとは">サブプライムとは？</h3>
<ul>
<li><strong>返済能力が低い人</strong>に対する住宅ローン</li>
<li>低収入、返済実績なし、クレジットスコアが低い層にも貸し出し</li>
<li>「どうせ家の値段は上がるから大丈夫」という安易な前提</li>
</ul>
<hr>
</section>
</section>
<section id="なぜ銀行はリスクを無視したのか" class="level2">
<h2 class="anchored" data-anchor-id="なぜ銀行はリスクを無視したのか">3. なぜ銀行はリスクを無視したのか？</h2>
<section id="住宅価格はずっと上がると信じられていた" class="level3">
<h3 class="anchored" data-anchor-id="住宅価格はずっと上がると信じられていた">✔ 住宅価格はずっと上がると信じられていた</h3>
<p>もし借り手が返済不能になっても： - 銀行は家を差し押さえる<br>
- <strong>家の価格は上昇し続けていた</strong><br>
→ 売れば利益が出ると考えられていた</p>
</section>
<section id="ローンは投資銀行へ売却できる" class="level3">
<h3 class="anchored" data-anchor-id="ローンは投資銀行へ売却できる">✔ ローンは投資銀行へ売却できる</h3>
<p>銀行はローンを保有し続けないため、 <strong>返済不能のリスクを自分で負わなかった。</strong></p>
<hr>
</section>
</section>
<section id="cdo-が危険化した-2-つの理由" class="level2">
<h2 class="anchored" data-anchor-id="cdo-が危険化した-2-つの理由">4. CDO が危険化した 2 つの理由</h2>
<section id="サブプライムローンの大量発生-デフォルト確率の爆増" class="level3">
<h3 class="anchored" data-anchor-id="サブプライムローンの大量発生-デフォルト確率の爆増">① サブプライムローンの大量発生 → <strong>デフォルト確率の爆増</strong></h3>
<p>返済能力が低い層へ無理に貸し出した結果：</p>
<ul>
<li>返済不能（default）が急増<br>
</li>
<li>CDO のキャッシュフローが激減<br>
</li>
<li>投資家へ支払いが行われない状態に</li>
</ul>
<hr>
</section>
<section id="cdo-が同じ種類のローンばかりに偏った" class="level3">
<h3 class="anchored" data-anchor-id="cdo-が同じ種類のローンばかりに偏った">② CDO が「同じ種類のローン」ばかりに偏った</h3>
<p>本来、CDO の安全性は <strong>分散</strong> によって支えられていた。</p>
<p>しかし現実は：</p>
<pre><code>理想の CDO（多様なローン）
- 住宅ローン
- 自動車ローン
- 学生ローン
- クレジットカードローン
(相関が低い → 安全)</code></pre>
<pre><code>危機前の CDO（サブプライムだらけ）
- 住宅ローン（x1000）
(相関が極めて高い → 全部同時に崩れる)</code></pre>
<p>➡ <strong>相関が高いと、一つ崩れれば全部崩れる</strong></p>
<p>この「分散の崩壊」が最大の問題だった。</p>
<hr>
</section>
</section>
<section id="投資家に何が起きたか" class="level2">
<h2 class="anchored" data-anchor-id="投資家に何が起きたか">5. 投資家に何が起きたか？</h2>
<p>CDO には AAA（最上位の信用格付）が与えられていたが…</p>
<ul>
<li>サブプライム層の大量デフォルト</li>
<li>多数の CDO からキャッシュフローが消失</li>
<li><strong>AAA のはずのシニアトランシェですら損失</strong></li>
</ul>
<p>投資家は <strong>「安全資産だと思って買ったのに支払いが来ない」</strong> という状況に陥った。</p>
<hr>
</section>
<section id="システム全体が凍結credit-crunch" class="level2">
<h2 class="anchored" data-anchor-id="システム全体が凍結credit-crunch">6. システム全体が凍結（Credit Crunch）</h2>
<p>投資家が CDO を信用しなくなると：</p>
<ol type="1">
<li><strong>投資家</strong>：CDO を買わない<br>
</li>
<li><strong>投資銀行</strong>：CDO を売れない<br>
</li>
<li><strong>商業銀行</strong>：ローンを投資銀行へ売れない<br>
</li>
<li><strong>ローン審査</strong>が突然厳しくなる<br>
</li>
<li>住宅価格が下落（需要 evaporates）<br>
</li>
<li>サブプライム層がさらに返済不能<br>
</li>
<li>CDO の損失が雪だるま式に増える</li>
</ol>
<p>→ <strong>信用が連鎖的に消えていく “信用収縮（Credit Crunch）”</strong></p>
<hr>
</section>
<section id="そして-2008-年大崩壊へ" class="level2">
<h2 class="anchored" data-anchor-id="そして-2008-年大崩壊へ">7. そして 2008 年、大崩壊へ</h2>
<ul>
<li>レバレッジ（借金による投資）を使って CDO を大量に保有していた投資銀行が次々破綻<br>
</li>
<li>Lehman Brothers（リーマン・ブラザーズ）の破綻<br>
</li>
<li>世界中の金融市場がパニックに</li>
</ul>
<p>これが <strong>2007–2008 の世界金融危機</strong> だった。</p>
<hr>
</section>
<section id="まとめ-1" class="level2">
<h2 class="anchored" data-anchor-id="まとめ-1">まとめ</h2>
<ul>
<li>CDO 自体は金融工学的に美しい構造だった<br>
</li>
<li>しかし <strong>サブプライムの大量投入 + 分散の崩壊 + 格付けの誤り</strong> が連鎖破綻を起こした<br>
</li>
<li>住宅価格が永遠に上がるという幻想が崩れた瞬間、システム全体が瓦解した</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>